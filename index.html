<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Scent Selector</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        :root{--bg-color:#ffffff;--text-color:#000000;--card-bg:#f5f5f7;--accent:#007AFF;--accent-hover:#0051D5;--border:#d1d1d6;--shadow:rgba(0,0,0,0.1);}
        @media (prefers-color-scheme: dark) {:root{--bg-color:#000000;--text-color:#ffffff;--card-bg:#1c1c1e;--accent:#0A84FF;--accent-hover:#409CFF;--border:#38383a;--shadow:rgba(255,255,255,0.1);}}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg-color);color:var(--text-color);padding:15px;padding-bottom:30px;line-height:1.6;min-height:100vh;}
        .container{max-width:600px;margin:0 auto;}
        h1{font-size:32px;font-weight:700;margin-bottom:10px;text-align:center;}
        .subtitle{text-align:center;opacity:0.7;margin-bottom:25px;font-size:14px;}
        .section{margin-bottom:25px;}
        .section-title{font-size:20px;font-weight:600;margin-bottom:15px;}
        .button-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px;}
        button{background:var(--card-bg);border:2px solid var(--border);color:var(--text-color);padding:0;border-radius:16px;font-size:18px;font-weight:500;cursor:pointer;transition:all 0.2s;-webkit-tap-highlight-color:transparent;aspect-ratio:1/1;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:140px;}
        button:active{transform:scale(0.95);}
        button.selected{background:var(--accent);color:white;border-color:var(--accent);}
        button.primary{background:var(--accent);color:white;border-color:var(--accent);font-size:18px;padding:20px;margin-top:20px;width:100%;aspect-ratio:auto;min-height:auto;}
        button.secondary{background:transparent;border:2px solid var(--accent);color:var(--accent);width:100%;margin-top:10px;padding:18px;aspect-ratio:auto;min-height:auto;}
        .weather-temp{font-size:13px;opacity:0.8;display:block;margin-top:6px;}
        .recommendation-card{background:var(--card-bg);border-radius:12px;padding:20px;margin-bottom:15px;border:1px solid var(--border);}
        .combo-card{background:linear-gradient(135deg,var(--accent) 0%,#0051D5 100%);color:white;border-radius:12px;padding:20px;margin-bottom:15px;border:none;cursor:pointer;transition:transform 0.2s;}
        .combo-card:active{transform:scale(0.98);}
        .combo-badge{display:inline-block;background:rgba(255,255,255,0.3);padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;margin-bottom:10px;}
        .rec-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
        .rec-name{font-size:18px;font-weight:600;}
        .rec-reason{font-size:14px;line-height:1.5;opacity:0.9;margin-bottom:12px;}
        .spray-guide{background:rgba(0,122,255,0.1);padding:12px;border-radius:8px;margin-bottom:12px;font-size:13px;}
        .spray-title{font-weight:600;margin-bottom:4px;color:var(--accent);}
        .pairs-with{background:rgba(255,215,0,0.1);padding:10px;border-radius:8px;margin-bottom:12px;font-size:13px;}
        .pairs-title{font-weight:600;margin-bottom:6px;color:#FFD700;}
        .pair-link{display:inline-block;background:rgba(255,215,0,0.2);padding:6px 12px;border-radius:8px;margin:4px 4px 4px 0;cursor:pointer;transition:all 0.2s;color:var(--text-color);}
        .pair-link:active{transform:scale(0.95);background:rgba(255,215,0,0.3);}
        .rec-actions{display:flex;gap:10px;}
        .rec-actions button{flex:1;padding:10px;font-size:14px;aspect-ratio:auto;min-height:auto;}
        .hidden{display:none;}
        .back-button{background:transparent;border:none;color:var(--accent);padding:10px;font-size:16px;cursor:pointer;margin-bottom:20px;aspect-ratio:auto;min-height:auto;}
        .nav-tabs{display:flex;gap:10px;margin-bottom:20px;overflow-x:auto;-webkit-overflow-scrolling:touch;}
        .nav-tab{padding:10px 20px;background:var(--card-bg);border:1px solid var(--border);border-radius:20px;white-space:nowrap;font-size:14px;aspect-ratio:auto;min-height:auto;}
        .nav-tab.active{background:var(--accent);color:white;border-color:var(--accent);}
        .history-item{background:var(--card-bg);padding:15px;border-radius:10px;margin-bottom:10px;font-size:14px;cursor:pointer;transition:all 0.2s;}
        .history-item:active{transform:scale(0.98);background:var(--border);}
        .history-date{opacity:0.6;font-size:12px;margin-top:5px;}
        .favorite-item{background:var(--card-bg);padding:15px;border-radius:10px;margin-bottom:10px;}
        .combo-type-badge{display:inline-block;background:rgba(0,122,255,0.2);color:var(--accent);padding:4px 8px;border-radius:6px;font-size:11px;font-weight:600;margin-left:8px;}
        input,select,textarea{width:100%;padding:12px;background:var(--card-bg);border:1px solid var(--border);border-radius:10px;color:var(--text-color);font-size:16px;margin-bottom:10px;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;}
        textarea{min-height:120px;resize:vertical;}
        .empty-state{text-align:center;padding:40px 20px;opacity:0.6;}
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <div id="nav" class="nav-tabs hidden">
            <button class="nav-tab active" onclick="showTab('selector', this)">Selector</button>
            <button class="nav-tab" onclick="showTab('history', this)">History</button>
            <button class="nav-tab" onclick="showTab('favorites', this)">Favorites</button>
            <button class="nav-tab" onclick="showTab('notes', this)">Notes</button>
        </div>

        <!-- Main Selector Screen -->
        <div id="selectorScreen">
            <h1>Scent Selector</h1>
            <p class="subtitle">Your Personal Fragrance Assistant</p>

            <!-- Season Selection -->
            <div id="seasonSection" class="section">
                <h2 class="section-title">What's the season?</h2>
                <div class="button-grid">
                    <button onclick="selectSeason('winter')">‚ùÑÔ∏è<br>Winter</button>
                    <button onclick="selectSeason('spring')">üå∏<br>Spring</button>
                    <button onclick="selectSeason('summer')">‚òÄÔ∏è<br>Summer</button>
                    <button onclick="selectSeason('fall')">üçÇ<br>Fall</button>
                </div>
            </div>

            <!-- Weather Selection -->
            <div id="weatherSection" class="section hidden">
                <button class="back-button" onclick="goBack('season')">‚Üê Back</button>
                <h2 class="section-title">What's the weather like?</h2>
                <div id="weatherButtons" class="button-grid"></div>
            </div>

            <!-- Situation Selection -->
            <div id="situationSection" class="section hidden">
                <button class="back-button" onclick="goBack('weather')">‚Üê Back</button>
                <h2 class="section-title">What's the occasion?</h2>
                <div class="button-grid">
                    <button onclick="selectSituation('work')">üíº<br>Work</button>
                    <button onclick="selectSituation('casual')">üëü<br>Casual</button>
                    <button onclick="selectSituation('date')">üíë<br>Date Night</button>
                    <button onclick="selectSituation('intimate')">üî•<br>Intimate</button>
                </div>
            </div>

            <!-- Suspense Selection -->
            <div id="suspenseSection" class="section hidden">
                <button class="back-button" onclick="goBack('situation')">‚Üê Back</button>
                <h2 class="section-title">Build Suspense?</h2>
                <p style="text-align:center;opacity:0.7;margin-bottom:20px;font-size:14px;">Planning a date that might lead somewhere special?</p>
                <div class="button-grid">
                    <button onclick="selectSuspense(true)">üòè<br>Yes</button>
                    <button onclick="selectSuspense(false)">üçΩÔ∏è<br>No</button>
                </div>
            </div>
        </div>
        <!-- Results Screen -->
        <div id="resultsScreen" class="hidden">
            <button class="back-button" onclick="goBackToStart()">‚Üê Start Over</button>
            <h2 class="section-title" id="resultsTitle">Your Recommendations</h2>
            <div id="recommendations"></div>
            <button class="secondary" onclick="surpriseMe()">üé≤ Surprise Me!</button>
            <button class="secondary" onclick="showWhatAmIWearing()">What Am I Wearing?</button>
        </div>

        <!-- What Am I Wearing Screen -->
        <div id="wearingScreen" class="hidden">
            <button class="back-button" onclick="goBack('results')">‚Üê Back</button>
            <h2 class="section-title">What Are You Wearing?</h2>
            <select id="wearingSelect"></select>
            <button class="primary" onclick="logWearing()">Log It</button>
        </div>

        <!-- History Screen -->
        <div id="historyScreen" class="hidden">
            <h2 class="section-title">Wear History</h2>
            <div id="historyList"></div>
        </div>

        <!-- Favorites Screen -->
        <div id="favoritesScreen" class="hidden">
            <h2 class="section-title">Favorites</h2>
            <div id="favoritesList"></div>
        </div>

        <!-- Notes Screen -->
        <div id="notesScreen" class="hidden">
            <h2 class="section-title">General Notes</h2>
            <textarea id="generalNotes" placeholder="Fragrance notes, shopping list, thoughts..."></textarea>
            <button class="primary" onclick="saveGeneralNotes()">Save Notes</button>
        </div>
    </div>

    <script>
        // Data
        const fragranceData={
            "Phantom Noir":{notes:"Coffee, rum, vanilla",seasons:["winter","fall"],pairsWith:["Brooklyn Jazz"]},
            "Brooklyn Jazz":{notes:"Rum, tobacco, vanilla",seasons:["winter","fall"],pairsWith:["Phantom Noir"]},
            "Aventus":{notes:"Pineapple, birch",seasons:["spring","summer"],pairsWith:["Gentle Silver"]},
            "Gentle Silver":{notes:"Juniper, nutmeg",seasons:["spring","summer"],pairsWith:["Aventus"]},
            "Lost Cherry":{notes:"Cherry, almond",seasons:["winter"],pairsWith:["1 Million"]},
            "1 Million":{notes:"Cinnamon, leather",seasons:["winter"],pairsWith:["Lost Cherry"]},
            "Cubicle for Men":{notes:"Fresh, woody",seasons:["all"],pairsWith:[]},
            "Vanille Absolute":{notes:"Vanilla, ginger",seasons:["fall"],pairsWith:["Brooklyn Jazz"]}
        };

        const weatherOptions={
            winter:[{id:'freezing',emoji:'‚ùÑÔ∏è',label:'Freezing',temp:'<25¬∞F',modifier:1.3},{id:'cold',emoji:'üå®Ô∏è',label:'Cold',temp:'25-40¬∞F',modifier:1.15},{id:'cool',emoji:'‚òÅÔ∏è',label:'Cool',temp:'40-50¬∞F',modifier:1.0}],
            spring:[{id:'chilly',emoji:'üåßÔ∏è',label:'Chilly',temp:'45-55¬∞F',modifier:1.0},{id:'pleasant',emoji:'üå§Ô∏è',label:'Pleasant',temp:'65-75¬∞F',modifier:0.8}],
            summer:[{id:'hot',emoji:'‚òÄÔ∏è',label:'Hot',temp:'80-90¬∞F',modifier:0.6}],
            fall:[{id:'chilly',emoji:'üçÇ',label:'Chilly',temp:'45-55¬∞F',modifier:1.0}]
        };

        // State (NO BROKEN MODAL VARS)
        let currentSeason='',currentWeather='',currentWeatherModifier=1.0,currentSituation='',currentSuspense=null;
        let wearHistory=JSON.parse(localStorage.getItem('wearHistory')||'[]'),favorites=JSON.parse(localStorage.getItem('favorites')||'[]'),generalNotes=localStorage.getItem('generalNotes')||'';
        // Init
        function init(){loadHistory();loadFavorites();populateWearingSelect();loadGeneralNotes();}

        // Navigation
        function showTab(tab,el){document.querySelectorAll('[id$="Screen"]').forEach(s=>s.classList.add('hidden'));document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));if(el)el.classList.add('active');const screens={selector:'selectorScreen',history:'historyScreen',favorites:'favoritesScreen',notes:'notesScreen'};document.getElementById(screens[tab]).classList.remove('hidden');if(tab==='selector')goBackToStart();else if(tab==='notes')loadGeneralNotes();}

        // Selection flow
        function selectSeason(season){currentSeason=season;document.getElementById('seasonSection').classList.add('hidden');document.getElementById('weatherSection').classList.remove('hidden');document.getElementById('nav').classList.remove('hidden');const weatherButtons=document.getElementById('weatherButtons');weatherButtons.innerHTML='';weatherOptions[season].forEach(w=>{const btn=document.createElement('button');btn.innerHTML=`${w.emoji}<br>${w.label}<span class="weather-temp">${w.temp}</span>`;btn.onclick=()=>selectWeather(w.id,w.modifier);weatherButtons.appendChild(btn);});}
        function selectWeather(weather,modifier){currentWeather=weather;currentWeatherModifier=modifier;document.getElementById('weatherSection').classList.add('hidden');document.getElementById('situationSection').classList.remove('hidden');}
        function selectSituation(situation){currentSituation=situation;if(situation==='date'){document.getElementById('situationSection').classList.add('hidden');document.getElementById('suspenseSection').classList.remove('hidden');}else{currentSuspense=null;showRecommendations();}}
        function selectSuspense(suspense){currentSuspense=suspense;showRecommendations();}

        // Back nav
        function goBackToStart(){document.querySelectorAll('[id$="Screen"]').forEach(s=>s.classList.add('hidden'));document.getElementById('seasonSection').classList.remove('hidden');document.getElementById('nav').classList.add('hidden');currentSeason='';currentWeather='';currentSituation='';currentSuspense=null;}
        function goBack(to){if(to==='season'){document.getElementById('weatherSection').classList.add('hidden');document.getElementById('seasonSection').classList.remove('hidden');}else if(to==='weather'){document.getElementById('situationSection').classList.add('hidden');document.getElementById('suspenseSection').classList.add('hidden');document.getElementById('weatherSection').classList.remove('hidden');}else if(to==='results'){document.getElementById('wearingScreen').classList.add('hidden');document.getElementById('resultsScreen').classList.remove('hidden');}}

        // Recommendations
        function showRecommendations(){document.getElementById('suspenseSection').classList.add('hidden');document.getElementById('situationSection').classList.add('hidden');document.getElementById('resultsScreen').classList.remove('hidden');let occasion=currentSituation;if(currentSituation==='date')occasion=currentSuspense?'date-suspense':'date-public';const recs=[{name:"Phantom Noir",reason:"Coffee-rum seduction king"},{name:"Brooklyn Jazz",reason:"Boozy romance"},{name:"Aventus",reason:"Fresh confidence"}];const recsDiv=document.getElementById('recommendations');recsDiv.innerHTML='';recs.forEach(rec=>{const card=document.createElement('div');card.className='recommendation-card';card.innerHTML=`<div class="rec-name">${rec.name}</div><div class="rec-reason">${rec.reason}</div><div class="rec-actions"><button onclick="logFragrance('${rec.name}')">Wear This</button><button onclick="saveFavorite('${rec.name}','single')">‚≠ê Favorite</button></div>`;recsDiv.appendChild(card);});document.getElementById('resultsTitle').textContent=`${currentSituation.replace('-',' ').replace(/\b\w/g,c=>c.toUpperCase())} Recommendations`;}

        // Logging + Storage
        function logFragrance(name){const entry={type:'single',fragrance:name,season:currentSeason,weather:currentWeather,situation:currentSituation,date:new Date().toISOString()};wearHistory.unshift(entry);if(wearHistory.length>50)wearHistory=wearHistory.slice(0,50);localStorage.setItem('wearHistory',JSON.stringify(wearHistory));alert(`‚úÖ Logged: ${name}`);loadHistory();}
        function logWearing(){const f=document.getElementById('wearingSelect').value;if(!f){alert('Select fragrance');return;}logFragrance(f);goBack('results');}
        function saveFavorite(item,type){const fav={type,item,season:currentSeason||'any',situation:currentSituation||'any',date:new Date().toISOString()};favorites.unshift(fav);if(favorites.length>50)favorites=favorites.slice(0,50);localStorage.setItem('favorites',JSON.stringify(favorites));alert('‚≠ê Added to favorites!');loadFavorites();}
        function loadHistory(){const list=document.getElementById('historyList');if(wearHistory.length===0){list.innerHTML='<div class="empty-state">No wears logged yet</div>';return;}list.innerHTML='';wearHistory.slice(0,10).forEach(h=>{const item=document.createElement('div');item.className='history-item';item.innerHTML=`<strong>${h.type==='single'?h.fragrance:h.comboKey||h.fragrances?.join(' + ')}</strong><br>${h.season} ‚Ä¢ ${h.situation}<div class="history-date">${new Date(h.date).toLocaleDateString()}</div>`;list.appendChild(item);});}
        function loadFavorites(){const list=document.getElementById('favoritesList');if(favorites.length===0){list.innerHTML='<div class="empty-state">No favorites yet</div>';return;}list.innerHTML='';favorites.slice(0,10).forEach(fav=>{const item=document.createElement('div');item.className='favorite-item';item.innerHTML=`<strong>${fav.item}</strong><br>${fav.season} ‚Ä¢ ${fav.situation}<div class="history-date">${new Date(fav.date).toLocaleDateString()}</div>`;list.appendChild(item);});}
        function populateWearingSelect(){const select=document.getElementById('wearingSelect');select.innerHTML='<option value="">Choose...</option>';Object.keys(fragranceData).forEach(f=>{const opt=document.createElement('option');opt.value=f;opt.textContent=f;select.appendChild(opt);});}
        function loadGeneralNotes(){document.getElementById('generalNotes').value=generalNotes;}
        function saveGeneralNotes(){generalNotes=document.getElementById('generalNotes').value;localStorage.setItem('generalNotes',generalNotes);alert('‚úÖ Notes saved!');}
        function showWhatAmIWearing(){document.getElementById('resultsScreen').classList.add('hidden');document.getElementById('wearingScreen').classList.remove('hidden');}
        function surpriseMe(){const recs=[{name:"Phantom Noir"},{name:"Brooklyn Jazz"},{name:"Aventus"}];const pick=recs[Math.floor(Math.random()*recs.length)];alert(`üé≤ Surprise: ${pick.name}`);logFragrance(pick.name);}

        // Start app
        init();
    </script>
</body>
</html>
