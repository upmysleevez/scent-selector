<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Scent Selector</title>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        :root{--bg-color:#ffffff;--text-color:#000000;--card-bg:#f5f5f7;--accent:#007AFF;--accent-hover:#0051D5;--border:#d1d1d6;--shadow:rgba(0,0,0,0.1);}
        @media (prefers-color-scheme: dark) {:root{--bg-color:#000000;--text-color:#ffffff;--card-bg:#1c1c1e;--accent:#0A84FF;--accent-hover:#409CFF;--border:#38383a;--shadow:rgba(255,255,255,0.1);}}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg-color);color:var(--text-color);padding:15px;padding-bottom:30px;line-height:1.6;min-height:100vh;}
        .container{max-width:600px;margin:0 auto;}
        h1{font-size:32px;font-weight:700;margin-bottom:10px;text-align:center;}
        .subtitle{text-align:center;opacity:0.7;margin-bottom:25px;font-size:14px;}
        .section{margin-bottom:25px;}
        .section-title{font-size:20px;font-weight:600;margin-bottom:15px;}
        .button-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px;}
        button{background:var(--card-bg);border:2px solid var(--border);color:var(--text-color);padding:0;border-radius:16px;font-size:18px;font-weight:500;cursor:pointer;transition:all 0.2s;-webkit-tap-highlight-color:transparent;aspect-ratio:1/1;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:140px;}
        button:active{transform:scale(0.95);}
        button.selected{background:var(--accent);color:white;border-color:var(--accent);}
        button.primary{background:var(--accent);color:white;border-color:var(--accent);font-size:18px;padding:20px;margin-top:20px;width:100%;aspect-ratio:auto;min-height:auto;}
        button.secondary{background:transparent;border:2px solid var(--accent);color:var(--accent);width:100%;margin-top:10px;padding:18px;aspect-ratio:auto;min-height:auto;}
        .weather-temp{font-size:13px;opacity:0.8;display:block;margin-top:6px;}
        .recommendation-card{background:var(--card-bg);border-radius:12px;padding:20px;margin-bottom:15px;border:1px solid var(--border);}
        .combo-card{background:linear-gradient(135deg,var(--accent) 0%,#0051D5 100%);color:white;border-radius:12px;padding:20px;margin-bottom:15px;border:none;cursor:pointer;transition:transform 0.2s;}
        .combo-card:active{transform:scale(0.98);}
        .combo-badge{display:inline-block;background:rgba(255,255,255,0.3);padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;margin-bottom:10px;}
        .rec-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
        .rec-name{font-size:18px;font-weight:600;}
        .rec-reason{font-size:14px;line-height:1.5;opacity:0.9;margin-bottom:12px;}
        .spray-guide{background:rgba(0,122,255,0.1);padding:12px;border-radius:8px;margin-bottom:12px;font-size:13px;}
        .spray-title{font-weight:600;margin-bottom:4px;color:var(--accent);}
        .pairs-with{background:rgba(255,215,0,0.1);padding:10px;border-radius:8px;margin-bottom:12px;font-size:13px;}
        .pairs-title{font-weight:600;margin-bottom:6px;color:#FFD700;}
        .pair-link{display:inline-block;background:rgba(255,215,0,0.2);padding:6px 12px;border-radius:8px;margin:4px 4px 4px 0;cursor:pointer;color:var(--text-color);}
        .rec-actions{display:flex;gap:10px;margin-top:15px;}
        .rec-actions button{flex:1;padding:10px;font-size:14px;aspect-ratio:auto;min-height:auto;}
        .hidden{display:none;}
        .back-button{background:transparent;border:none;color:var(--accent);padding:10px;font-size:16px;cursor:pointer;margin-bottom:20px;aspect-ratio:auto;min-height:auto;}
        .nav-tabs{display:flex;gap:10px;margin-bottom:20px;overflow-x:auto;-webkit-overflow-scrolling:touch;}
        .nav-tab{padding:10px 20px;background:var(--card-bg);border:1px solid var(--border);border-radius:20px;white-space:nowrap;font-size:14px;aspect-ratio:auto;min-height:auto;cursor:pointer;}
        .nav-tab.active{background:var(--accent);color:white;border-color:var(--accent);}
        .history-item{background:var(--card-bg);padding:15px;border-radius:10px;margin-bottom:10px;font-size:14px;cursor:pointer;}
        .history-item:active{transform:scale(0.98);}
        .history-date{opacity:0.6;font-size:12px;margin-top:5px;}
        .favorite-item{background:var(--card-bg);padding:15px;border-radius:10px;margin-bottom:10px;}
        .combo-type-badge{display:inline-block;background:rgba(0,122,255,0.2);color:var(--accent);padding:4px 8px;border-radius:6px;font-size:11px;font-weight:600;margin-left:8px;}
        input,select,textarea{width:100%;padding:12px;background:var(--card-bg);border:1px solid var(--border);border-radius:10px;color:var(--text-color);font-size:16px;margin-bottom:10px;font-family:inherit;}
        textarea{min-height:120px;resize:vertical;}
        .empty-state{text-align:center;padding:40px 20px;opacity:0.6;}
        .delete-btn{background:#FF3B30;color:white;border:none;padding:8px 16px;border-radius:8px;font-size:14px;cursor:pointer;}
    
        .history-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;}
        .history-actions{display:flex;gap:8px;}
        .edit-btn,.delete-btn{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;border-radius:6px;transition:all 0.2s;opacity:0.7;}
        .edit-btn:active,.delete-btn:active{transform:scale(0.9);opacity:1;}
        .history-context{font-size:13px;color:var(--text-color);opacity:0.6;margin-bottom:8px;}
        .history-rating{font-size:14px;font-weight:600;color:var(--accent);margin-bottom:6px;}
        .history-reasoning{font-size:13px;background:var(--card-bg);padding:8px 12px;border-radius:8px;margin:6px 0;border-left:3px solid var(--accent);}
        .history-sprays{font-size:13px;background:var(--card-bg);padding:8px 12px;border-radius:8px;margin:6px 0;}
        .rating-section{background:var(--card-bg);padding:20px;border-radius:12px;margin-bottom:20px;border:1px solid var(--border);}
        .rating-label{font-weight:600;margin-bottom:12px;display:block;font-size:16px;}
        .stars-container{display:flex;gap:10px;justify-content:center;margin-bottom:20px;}
        .star{font-size:36px;cursor:pointer;opacity:0.3;transition:all 0.2s;}
        .star:active{transform:scale(1.15);}
        .star.active{opacity:1;transform:scale(1.1);}
        .reasoning-input{width:100%;padding:12px;border:1px solid var(--border);border-radius:8px;background:var(--bg-color);color:var(--text-color);font-family:inherit;font-size:14px;resize:vertical;min-height:80px;margin-bottom:12px;}
        .spray-group{display:flex;align-items:center;gap:12px;margin-top:12px;}
        .spray-input{width:80px;padding:8px;border:1px solid var(--border);border-radius:8px;background:var(--bg-color);color:var(--text-color);text-align:center;font-size:16px;}
        </style>
</head>
<body>
    <div class="container">
        <div id="nav" class="nav-tabs hidden">
            <button class="nav-tab active" onclick="showTab('selector',this)">Selector</button>
            <button class="nav-tab" onclick="showTab('history',this)">History</button>
            <button class="nav-tab" onclick="showTab('favorites',this)">Favorites</button>
            <button class="nav-tab" onclick="showTab('notes',this)">Notes</button>
        </div>
        <div id="selectorScreen">
            <h1>Scent Selector</h1>
            <p class="subtitle">Your Personal Fragrance Assistant</p>
            <div id="seasonSection" class="section">
                <h2 class="section-title">What's the season?</h2>
                <div class="button-grid">
                    <button onclick="selectSeason('winter')">‚ùÑÔ∏è<br>Winter</button>
                    <button onclick="selectSeason('spring')">üå∏<br>Spring</button>
                    <button onclick="selectSeason('summer')">‚òÄÔ∏è<br>Summer</button>
                    <button onclick="selectSeason('fall')">üçÇ<br>Fall</button>
                </div>
            </div>
            <div id="weatherSection" class="section hidden">
                <button class="back-button" onclick="goBack('season')">‚Üê Back</button>
                <h2 class="section-title">What's the weather like?</h2>
                <div id="weatherButtons" class="button-grid"></div>
            </div>
            <div id="situationSection" class="section hidden">
                <button class="back-button" onclick="goBack('weather')">‚Üê Back</button>
                <h2 class="section-title">What's the occasion?</h2>
                <div class="button-grid">
                    <button onclick="selectSituation('work')">üíº<br>Work</button>
                    <button onclick="selectSituation('casual')">üëü<br>Casual</button>
                    <button onclick="selectSituation('date')">üíë<br>Date Night</button>
                    <button onclick="selectSituation('intimate')">üî•<br>Intimate</button>
                </div>
            </div>
            <div id="suspenseSection" class="section hidden">
                <button class="back-button" onclick="goBack('situation')">‚Üê Back</button>
                <h2 class="section-title">Build Suspense?</h2>
                <p style="text-align:center;opacity:0.7;margin-bottom:20px;font-size:14px;">Are you planning a date that might lead somewhere special?</p>
                <div class="button-grid">
                    <button onclick="selectSuspense(true)">üòè<br>Yes</button>
                    <button onclick="selectSuspense(false)">üçΩÔ∏è<br>No</button>
                </div>
            </div>
        </div>
        <div id="resultsScreen" class="hidden">
            <button class="back-button" onclick="goBackToStart()">‚Üê Start Over</button>
            <h2 class="section-title" id="resultsTitle">Your Recommendations</h2>
            <div id="recommendations"></div>
            <div class="rating-section">
                <label class="rating-label">Rate This Choice</label>
                <div class="stars-container">
                    <span class="star" onclick="setStar(1)">‚≠ê</span>
                    <span class="star" onclick="setStar(2)">‚≠ê</span>
                    <span class="star" onclick="setStar(3)">‚≠ê</span>
                    <span class="star" onclick="setStar(4)">‚≠ê</span>
                    <span class="star" onclick="setStar(5)">‚≠ê</span>
                </div>
                <textarea id="reasoningText" class="reasoning-input" placeholder="Why did you choose this? (optional)"></textarea>
                <div class="spray-group">
                    <label for="sprayCount" style="font-weight:600;">Sprays:</label>
                    <input type="number" id="sprayCount" class="spray-input" min="1" max="10" value="1">
                </div>
            </div>
            <button class="secondary" onclick="surpriseMe()">üé≤ Surprise Me!</button>
            <button class="secondary" onclick="showWhatAmIWearing()">What Am I Wearing?</button>
        </div>
        <div id="wearingScreen" class="hidden">
            <button class="back-button" onclick="goBack('results')">‚Üê Back</button>
            <h2 class="section-title">What Are You Wearing?</h2>
            <select id="wearingSelect"></select>
            <button class="primary" onclick="logWearing()">Log It</button>
        </div>
        <div id="historyScreen" class="hidden">
            <h2 class="section-title">Wear History</h2>
            <div id="historyList"></div>
        </div>
        <div id="favoritesScreen" class="hidden">
            <h2 class="section-title">Favorites</h2>
            <div id="favoritesList"></div>
        </div>
        <div id="notesScreen" class="hidden">
            <h2 class="section-title">General Notes</h2>
            <textarea id="generalNotes" placeholder="Add your fragrance notes, shopping list, thoughts..."></textarea>
            <button class="primary" onclick="saveGeneralNotes()">Save Notes</button>
        </div>
    </div>
    <script>
        const fragranceData={
            "Phantom Noir":{notes:"Coffee, rum, vanilla, caramel",seasons:["winter","fall"],pairsWith:["Brooklyn Jazz","1 Million"]},
            "Brooklyn Jazz":{notes:"Rum, tobacco, vanilla, tonka",seasons:["winter","fall","spring"],pairsWith:["Phantom Noir","Vanille Absolute"]},
            "Vanille Absolute":{notes:"Vanilla, ginger, pink pepper",seasons:["fall","winter"],pairsWith:["Aventus","Brooklyn Jazz"]},
            "Lost Cherry":{notes:"Cherry, almond, tonka bean",seasons:["winter","fall"],pairsWith:["1 Million","Ambery Saffron"]},
            "Aventus":{notes:"Pineapple, birch, oakmoss",seasons:["spring","summer","fall"],pairsWith:["Ambery Saffron","Gentle Silver"]},
            "Gentle Silver":{notes:"Juniper, nutmeg, vanilla",seasons:["spring","summer","fall","winter"],pairsWith:["Aventus","Cubicle for Men"]},
            "Maison du Soir":{notes:"Chestnut, cloves, vanilla",seasons:["winter","fall"],pairsWith:["BLOMB No. 27"]},
            "BLOMB No. 27":{notes:"Tobacco, coconut, sandalwood",seasons:["winter","fall"],pairsWith:["Maison du Soir"]},
            "Cubicle for Men":{notes:"Fresh, woody, ambroxan",seasons:["spring","summer","fall","winter"],pairsWith:["Gentle Silver"]},
            "1 Million":{notes:"Cinnamon, leather, amber",seasons:["winter","fall"],pairsWith:["Lost Cherry","Phantom Noir"]},
            "Ambery Saffron":{notes:"Amber, saffron, woody",seasons:["winter","fall","spring"],pairsWith:["Aventus","Lost Cherry"]}
        };
        const comboDetails={
            "1 Million + Lost Cherry":{name:"Winter Date Power",why:"Sweet cherry meets bold cinnamon.",application:{first:{name:"Lost Cherry",sprays:2,placement:"1 neck, 1 chest"},wait:"Wait 5 min",second:{name:"1 Million",sprays:1,placement:"1 left wrist"}},bestFor:"Winter date-suspense",seasons:["winter"]},
            "Aventus + Vanille Absolute":{name:"Fall Romance",why:"Spicy vanilla meets fruity Aventus.",application:{first:{name:"Aventus",sprays:1,placement:"1 chest"},wait:"Wait 2-3 min",second:{name:"Vanille Absolute",sprays:2,placement:"1 neck, 1 right wrist"}},bestFor:"Fall date-suspense",seasons:["fall"]},
            "Brooklyn Jazz + Phantom Noir":{name:"Boozy Brothers",why:"Coffee-rum meets rum-tobacco.",application:{first:{name:"Phantom Noir",sprays:2,placement:"1 neck, 1 chest"},wait:"Wait 5 min",second:{name:"Brooklyn Jazz",sprays:1,placement:"1 left wrist"}},bestFor:"Winter date-public",seasons:["winter","fall"]}
        };
        const weatherOptions={winter:[{id:'freezing',emoji:'‚ùÑÔ∏è',label:'Freezing',temp:'<25¬∞F',modifier:1.3},{id:'cold',emoji:'üå®Ô∏è',label:'Cold',temp:'25-40¬∞F',modifier:1.15},{id:'cool',emoji:'‚òÅÔ∏è',label:'Cool',temp:'40-50¬∞F',modifier:1.0},{id:'mild',emoji:'üå§Ô∏è',label:'Mild',temp:'50-60¬∞F',modifier:0.85}],spring:[{id:'chilly',emoji:'üåßÔ∏è',label:'Chilly',temp:'45-55¬∞F',modifier:1.0},{id:'moderate',emoji:'‚òÅÔ∏è',label:'Moderate',temp:'55-65¬∞F',modifier:0.9},{id:'pleasant',emoji:'üå§Ô∏è',label:'Pleasant',temp:'65-75¬∞F',modifier:0.8},{id:'warm',emoji:'‚òÄÔ∏è',label:'Warm',temp:'75-85¬∞F',modifier:0.7}],summer:[{id:'comfortable',emoji:'üå§Ô∏è',label:'Comfortable',temp:'70-80¬∞F',modifier:0.8},{id:'hot',emoji:'‚òÄÔ∏è',label:'Hot',temp:'80-90¬∞F',modifier:0.6},{id:'veryhot',emoji:'üî•',label:'Very Hot',temp:'90-95¬∞F',modifier:0.5},{id:'extreme',emoji:'ü•µ',label:'Extreme',temp:'95¬∞F+',modifier:0.4}],fall:[{id:'chilly',emoji:'üçÇ',label:'Chilly',temp:'45-55¬∞F',modifier:1.0},{id:'moderate',emoji:'‚òÅÔ∏è',label:'Moderate',temp:'55-65¬∞F',modifier:0.9},{id:'pleasant',emoji:'üå§Ô∏è',label:'Pleasant',temp:'65-75¬∞F',modifier:0.8},{id:'warm',emoji:'‚òÄÔ∏è',label:'Warm',temp:'75-85¬∞F',modifier:0.7}]};
        let currentSeason='',currentWeather='',currentWeatherModifier=1.0,currentSituation='',currentSuspense=null;
        let wearHistory=JSON.parse(localStorage.getItem('wearHistory')||'[]'),favorites=JSON.parse(localStorage.getItem('favorites')||'[]'),generalNotes=localStorage.getItem('generalNotes')||'';
        function init(){loadHistory();loadFavorites();populateWearingSelect();loadGeneralNotes();}
        function showTab(tab,el){document.querySelectorAll('[id$="Screen"]').forEach(s=>s.classList.add('hidden'));document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));if(el)el.classList.add('active');const screens={selector:'selectorScreen',history:'historyScreen',favorites:'favoritesScreen',notes:'notesScreen'};document.getElementById(screens[tab]).classList.remove('hidden');if(tab==='selector')goBackToStart();else if(tab==='notes')loadGeneralNotes();}
        function selectSeason(season){currentSeason=season;document.getElementById('seasonSection').classList.add('hidden');document.getElementById('weatherSection').classList.remove('hidden');document.getElementById('nav').classList.remove('hidden');const weatherButtons=document.getElementById('weatherButtons');weatherButtons.innerHTML='';weatherOptions[season].forEach(w=>{const btn=document.createElement('button');btn.innerHTML=`${w.emoji}<br>${w.label}<span class="weather-temp">${w.temp}</span>`;btn.onclick=()=>selectWeather(w.id,w.modifier);weatherButtons.appendChild(btn);});}
        function selectWeather(weather,modifier){currentWeather=weather;currentWeatherModifier=modifier;document.getElementById('weatherSection').classList.add('hidden');document.getElementById('situationSection').classList.remove('hidden');}
        function selectSituation(situation){currentSituation=situation;if(situation==='date'){document.getElementById('situationSection').classList.add('hidden');document.getElementById('suspenseSection').classList.remove('hidden');}else{currentSuspense=null;showRecommendations();}}
        function selectSuspense(suspense){currentSuspense=suspense;showRecommendations();}
        function goBackToStart(){document.querySelectorAll('[id$="Screen"]').forEach(s=>s.classList.add('hidden'));document.getElementById('selectorScreen').classList.remove('hidden');document.getElementById('nav').classList.add('hidden');currentSeason='';currentWeather='';currentSituation='';currentSuspense=null;document.querySelectorAll('.star').forEach(s=>s.classList.remove('active'));document.getElementById('reasoningText').value='';document.getElementById('sprayCount').value='1';}
        function goBack(to){if(to==='season'){document.getElementById('weatherSection').classList.add('hidden');document.getElementById('seasonSection').classList.remove('hidden');}else if(to==='weather'){document.getElementById('situationSection').classList.add('hidden');document.getElementById('suspenseSection').classList.add('hidden');document.getElementById('weatherSection').classList.remove('hidden');}else if(to==='results'){document.getElementById('wearingScreen').classList.add('hidden');document.getElementById('resultsScreen').classList.remove('hidden');}}
       function showRecommendations(){document.getElementById('suspenseSection').classList.add('hidden');document.getElementById('situationSection').classList.add('hidden');document.getElementById('resultsScreen').classList.remove('hidden');let recs=[],combos=[];if(currentSeason==='winter'){recs=[{name:"Phantom Noir",reason:"Coffee-rum seduction"},{name:"Brooklyn Jazz",reason:"Boozy warmth"},{name:"1 Million",reason:"Spicy confidence"}];combos=["1 Million + Lost Cherry"];}else if(currentSeason==='summer'){recs=[{name:"Aventus",reason:"Fresh citrus power"},{name:"Gentle Silver",reason:"Light versatile"},{name:"Cubicle for Men",reason:"Cool freshness"}];combos=["Aventus + Vanille Absolute"];}else if(currentSeason==='spring'){recs=[{name:"Vanille Absolute",reason:"Spring warmth"},{name:"Aventus",reason:"Fresh brightness"},{name:"Gentle Silver",reason:"Balanced freshness"}];combos=["Aventus + Vanille Absolute"];}else if(currentSeason==='fall'){recs=[{name:"Lost Cherry",reason:"Autumn comfort"},{name:"Maison du Soir",reason:"Cozy spice"},{name:"Brooklyn Jazz",reason:"Warm depth"}];combos=["Brooklyn Jazz + Phantom Noir"];}if(currentSituation==='work'){recs=[{name:"Gentle Silver",reason:"Professional fresh"},{name:"Cubicle for Men",reason:"Understated"},{name:"Aventus",reason:"Confident but subtle"}];combos=[];}else if(currentSituation==='casual'){recs=[{name:"Aventus",reason:"Easy going"},{name:"Vanille Absolute",reason:"Relaxed"},{name:"Gentle Silver",reason:"Laid back"}];combos=[];}else if(currentSituation==='date'&&currentSuspense===true){recs=[{name:"Phantom Noir",reason:"Mystery & seduction"},{name:"Brooklyn Jazz",reason:"Intriguing warmth"},{name:"1 Million",reason:"Bold attraction"}];combos=["1 Million + Lost Cherry","Brooklyn Jazz + Phantom Noir"];}else if(currentSituation==='date'&&currentSuspense===false){recs=[{name:"Vanille Absolute",reason:"Romantic comfort"},{name:"Lost Cherry",reason:"Sweet attraction"},{name:"Aventus",reason:"Confident charm"}];combos=["Aventus + Vanille Absolute"];}else if(currentSituation==='intimate'){recs=[{name:"Phantom Noir",reason:"Deep seduction"},{name:"1 Million",reason:"Bold sensuality"},{name:"Brooklyn Jazz",reason:"Intimate warmth"}];combos=["1 Million + Lost Cherry","Brooklyn Jazz + Phantom Noir"];}const recsDiv=document.getElementById('recommendations');recsDiv.innerHTML='';recs.forEach(rec=>{const card=document.createElement('div');card.className='recommendation-card';card.innerHTML=`<div class="rec-name">${rec.name}</div><div class="rec-reason">${rec.reason}</div><div class="rec-actions"><button onclick="logFragrance('${rec.name}')">Wear This</button><button onclick="saveFavorite('${rec.name}','single')">‚≠ê Favorite</button></div>`;recsDiv.appendChild(card);});if(combos.length>0){combos.forEach(comboKey=>{if(comboDetails[comboKey]){const combo=comboDetails[comboKey];const card=document.createElement('div');card.className='combo-card';card.innerHTML=`<div class="combo-badge">COMBO</div><div style="font-size:18px;font-weight:600;margin-bottom:10px;">${combo.name}</div><div>${combo.why}</div><div class="rec-actions" style="margin-top:15px;"><button style="flex:1;padding:10px;font-size:14px;background:rgba(255,255,255,0.2);border:none;border-radius:8px;color:white;cursor:pointer;" onclick="logCombo('${comboKey}')">Try This Combo</button></div>`;recsDiv.appendChild(card);}});}}
function logCombo(comboKey){const fragrances=comboKey.split(' + ');const rating=document.querySelectorAll('.star.active').length;const reasoning=document.getElementById('reasoningText').value;const sprays=parseInt(document.getElementById('sprayCount').value)||1;const entry={type:'combo',comboKey,fragrances,season:currentSeason,weather:currentWeather,situation:currentSituation,date:new Date().toISOString(),rating,reasoning,sprays};wearHistory.unshift(entry);localStorage.setItem('wearHistory',JSON.stringify(wearHistory));alert(`‚úÖ Logged: ${fragrances.join(' + ')}`);loadHistory();goBackToStart();}
        function logFragrance(name){const rating=document.querySelectorAll('.star.active').length;const reasoning=document.getElementById('reasoningText').value;const sprays=parseInt(document.getElementById('sprayCount').value)||1;const entry={type:'single',fragrance:name,season:currentSeason,weather:currentWeather,situation:currentSituation,date:new Date().toISOString(),rating,reasoning,sprays};wearHistory.unshift(entry);if(wearHistory.length>50)wearHistory=wearHistory.slice(0,50);localStorage.setItem('wearHistory',JSON.stringify(wearHistory));alert(`‚úÖ Logged: ${name}`);loadHistory();goBackToStart();}
        function logWearing(){const f=document.getElementById('wearingSelect').value;if(!f){alert('Select a fragrance');return;}logFragrance(f);goBack('results');}
        function saveFavorite(item,type){const fav={type,item,note:'',date:new Date().toISOString()};favorites.unshift(fav);if(favorites.length>50)favorites=favorites.slice(0,50);localStorage.setItem('favorites',JSON.stringify(favorites));alert('‚≠ê Added to favorites!');loadFavorites();}
        function loadHistory(){const list=document.getElementById('historyList');if(wearHistory.length===0){list.innerHTML='<div class="empty-state">No wears logged yet</div>';return;}list.innerHTML='';wearHistory.forEach((h,idx)=>{const item=document.createElement('div');item.className='history-item';const fragName=h.fragrance||h.comboKey||'Unknown';const ratingStars='‚≠ê'.repeat(h.rating||0);const ratingText=h.rating?`${ratingStars} (${h.rating}/5)`:'Not rated';const reasoningText=h.reasoning?`<div class="history-reasoning"><strong>Reason:</strong> ${h.reasoning}</div>`:'';const sprayText=h.sprays?`<div class="history-sprays"><strong>Sprays:</strong> ${h.sprays}</div>`:'';item.innerHTML=`<div class="history-header"><strong>${fragName}</strong><div class="history-actions"><button class="edit-btn" onclick="editHistoryItem(${idx})" title="Edit">‚úèÔ∏è</button><button class="delete-btn" onclick="deleteHistoryItem(${idx})" title="Delete">üóëÔ∏è</button></div></div><div class="history-context">${h.season} ‚Ä¢ ${h.situation}</div><div class="history-rating">${ratingText}</div>${reasoningText}${sprayText}<div class="history-date">${new Date(h.date).toLocaleDateString()}</div>`;list.appendChild(item);});}
        function editHistoryItem(idx){const h=wearHistory[idx];if(!h)return;const fragName=h.fragrance||h.comboKey||'Unknown';const newReasoning=prompt('Edit reasoning for '+fragName,h.reasoning||'');if(newReasoning!==null){wearHistory[idx].reasoning=newReasoning;localStorage.setItem('wearHistory',JSON.stringify(wearHistory));loadHistory();}}function deleteHistoryItem(idx){const h=wearHistory[idx];if(!h)return;const fragName=h.fragrance||h.comboKey||'Unknown';if(confirm('Delete this wear log entry for '+fragName+'?')){wearHistory.splice(idx,1);localStorage.setItem('wearHistory',JSON.stringify(wearHistory));loadHistory();}}function setStar(num){document.querySelectorAll('.star').forEach((s,i)=>{if(i<num){s.classList.add('active');}else{s.classList.remove('active');}});}
        function loadFavorites(){const list=document.getElementById('favoritesList');if(favorites.length===0){list.innerHTML='<div class="empty-state">No favorites yet</div>';return;}list.innerHTML='';favorites.forEach((fav,idx)=>{const item=document.createElement('div');item.className='favorite-item';let noteHtml='';if(fav.note){noteHtml=`<div style="background:rgba(255,149,0,0.1);padding:10px;border-radius:8px;margin-top:10px;font-size:13px;font-style:italic;">${fav.note}</div>`;}item.innerHTML=`<div><strong>${fav.item}</strong></div><div style="margin-top:10px;display:flex;gap:8px;"><button class="delete-btn" onclick="deleteFavorite(${idx})">Delete</button><button style="background:#FF9500;color:white;border:none;padding:8px 16px;border-radius:8px;font-size:14px;cursor:pointer;" onclick="editFavoriteNote(${idx})">Edit Note</button></div>${noteHtml}`;list.appendChild(item);});}
        function deleteFavorite(idx){favorites.splice(idx,1);localStorage.setItem('favorites',JSON.stringify(favorites));loadFavorites();}
        function editFavoriteNote(idx){const newNote=prompt('Add note for '+favorites[idx].item,favorites[idx].note||'');if(newNote!==null){favorites[idx].note=newNote;localStorage.setItem('favorites',JSON.stringify(favorites));loadFavorites();}}
        function populateWearingSelect(){const select=document.getElementById('wearingSelect');select.innerHTML='<option value="">Choose a fragrance...</option>';Object.keys(fragranceData).forEach(f=>{const opt=document.createElement('option');opt.value=f;opt.textContent=f;select.appendChild(opt);});}
        function loadGeneralNotes(){document.getElementById('generalNotes').value=generalNotes;}
        function saveGeneralNotes(){generalNotes=document.getElementById('generalNotes').value;localStorage.setItem('generalNotes',generalNotes);alert('‚úÖ Notes saved!');}
        function showWhatAmIWearing(){document.getElementById('resultsScreen').classList.add('hidden');document.getElementById('wearingScreen').classList.remove('hidden');}
        function surpriseMe(){const fragrances=Object.keys(fragranceData);const pick=fragrances[Math.floor(Math.random()*fragrances.length)];alert(`üé≤ Surprise: ${pick}`);logFragrance(pick);}
        init();
    </script>
</body>
</html>
